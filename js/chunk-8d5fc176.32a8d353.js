(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8d5fc176"],{"11a5":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"v-knowledge-single"},[e("div",{staticClass:"m-navigation"},[e("el-button",{staticClass:"u-goback",attrs:{size:"medium",icon:"el-icon-arrow-left",plain:""},on:{click:t.goBack}},[t._v("返回列表")]),t.isEditor?e("el-button",{attrs:{size:"medium",icon:"el-icon-delete",plain:"",type:"danger"},on:{click:t.del}},[t._v("删除")]):t._e()],1),t.data&&t.data.post?e("div",{staticClass:"m-wiki"},[e("WikiPanel",{staticClass:"m-knowledge-panel",attrs:{"wiki-post":t.data}},[e("template",{slot:"head-title"},[e("svg",{class:"u-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 412.72 412.72","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{d:"M404.72 82.944h-27.2v-9.28a8 8 0 00-5.76-8 225.345 225.345 0 00-57.68-7.36c-32 0-75.6 7.2-107.84 40-32-33.12-75.92-40-107.84-40a225.345 225.345 0 00-57.68 7.36 8 8 0 00-5.76 8v9.2H8a8 8 0 00-8 8v255.52a8 8 0 008 8 7.996 7.996 0 003.92-1.04c.8-.4 80.8-44.16 192.48-16h1.92a8.008 8.008 0 001.92 0c112-28.4 192 15.28 192.48 16a8 8 0 0012-6.88V90.944a8 8 0 00-8-8zM16 333.664V98.944h19.12v200.64a8 8 0 009.2 8 350.096 350.096 0 0150-4 207.516 207.516 0 0168.32 10.32A294.1 294.1 0 0016 333.664zm78.32-46a351.994 351.994 0 00-43.52 2.8V79.984a220.645 220.645 0 0147.44-5.28c29.92 0 71.2 6.88 99.84 39.2l.24 199.28c-16.64-10.88-49.12-25.52-104-25.52zm120-173.76c28.64-32 69.92-39.2 99.84-39.2a221.61 221.61 0 0147.44 5.28v210.48a351.895 351.895 0 00-43.28-2.88c-54.56 0-87.12 14.64-104 25.52v-199.2zm182.32 219.76a294.158 294.158 0 00-146.96-19.76 208.008 208.008 0 0168.64-10.32 349.994 349.994 0 0150.32 3.92 8 8 0 009.2-8V98.944h19.12l-.32 234.72z"}})]),e("span",[t._v(t._s(t.title)+" ")])]),e("template",{slot:"head-actions"},[e("a",{staticClass:"el-button el-button--primary",attrs:{href:t.publishLink("knowledge/".concat(t.id))}},[e("i",{staticClass:"el-icon-edit"}),e("span",[t._v("完善百科通识")])])]),e("template",{slot:"body"},[e("Article",{attrs:{content:t.content}}),e("Thx",{key:"item-thx-"+t.id,staticClass:"m-thx",attrs:{postId:t.id,postType:"knowledge",postTitle:t.title,userId:t.author_id,adminBoxcoinEnable:!0,userBoxcoinEnable:!0,mode:"wiki",authors:t.authors}})],1)],2),t.id?e("WikiRevisions",{staticStyle:{"margin-bottom":"35px"},attrs:{type:"knowledge","source-id":t.id}}):t._e(),t.id?[e("el-divider",{attrs:{"content-position":"left"}},[t._v("讨论")]),e("Comment",{attrs:{id:t.id,category:"knowledge"}})]:t._e()],2):e("div",{staticClass:"m-wiki-null"},[e("i",{staticClass:"el-icon-s-opportunity"}),e("span",[t._v("暂无内容，我要")]),e("a",{staticClass:"s-link",attrs:{href:t.publishLink("knowledge/".concat(t.id))}},[t._v("完善百科通识")])])])},a=[],s=(n("b0c0"),n("4de4"),n("d3b7"),n("d81d"),n("14d9"),n("434b")),o=n("9616"),r=n("85e4"),c=n("662c"),u=n("9307"),d=n("c9d2"),l=n("a974"),p=n("23d8"),f={name:"Detail",data:function(){return{loading:!1,data:""}},components:{Article:l["a"],WikiPanel:c["a"],WikiRevisions:u["a"],Comment:p["a"]},computed:{id:function(){return this.$route.params.source_id},type:function(){var t,e;return null===(t=this.data)||void 0===t||null===(e=t.source)||void 0===e?void 0:e.type},isRevision:function(){return!!this.$route.params.post_id},author_id:function(){var t,e;return~~(null===(t=this.data)||void 0===t||null===(e=t.post)||void 0===e?void 0:e.user_id)},title:function(){var t,e;return null===(t=this.data)||void 0===t||null===(e=t.source)||void 0===e?void 0:e.name},content:function(){var t,e;return null===(t=this.data)||void 0===t||null===(e=t.post)||void 0===e?void 0:e.content},authors:function(){var t,e,n;return this.isRevision?[]:(null===(t=this.data)||void 0===t||null===(e=t.users)||void 0===e||null===(n=e.filter((function(t){return t.id})))||void 0===n?void 0:n.map((function(t){return{user_id:t.id,user_avatar:t.avatar,display_name:t.nickname}})))||[]},isEditor:function(){return d["a"].isEditor()}},methods:{getData:function(){var t=this;this.loading=!0,Object(s["a"])(this.id).then((function(e){t.data=e,t.data.source&&(t.data.source.post=t.data.post)})).finally((function(){t.loading=!1,Object(o["c"])(t.type,t.id)}))},getPostData:function(){var t=this;this.loading=!0,Object(s["d"])(this.$route.params.post_id).then((function(e){t.data=e,t.data.source&&(t.data.source.post=t.data.post)})).finally((function(){t.loading=!1,Object(o["c"])(t.type,t.id)}))},goBack:function(){var t,e;null!==(t=this.data)&&void 0!==t&&null!==(e=t.source)&&void 0!==e&&e.type?this.$router.push({name:"normal",params:{knowledge_type:this.data.source.type}}):this.$router.push({name:"index"})},publishLink:r["publishLink"],del:function(){var t=this;this.$confirm("此操作将永久删除该百科通识, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["g"])(t.id).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.goBack()})).catch((function(e){t.$message({type:"error",message:"删除失败!"})}))}))}},created:function(){this.getData(this.id)},watch:{"$route.params.post_id":{immediate:!0,handler:function(){this.$route.params.post_id&&this.getPostData()}}}},h=f,v=(n("2fc3"),n("2877")),m=Object(v["a"])(h,i,a,!1,null,null,null);e["default"]=m.exports},"13d5":function(t,e,n){"use strict";var i=n("23e7"),a=n("d58f").left,s=n("a640"),o=n("2d00"),r=n("605d"),c=!r&&o>79&&o<83,u=c||!s("reduce");i({target:"Array",proto:!0,forced:u},{reduce:function(t){var e=arguments.length;return a(this,t,e,e>1?arguments[1]:void 0)}})},"2fc3":function(t,e,n){"use strict";n("896d")},"434b":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"e",(function(){return s})),n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return r})),n.d(e,"c",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"g",(function(){return d}));var i=n("41cb");function a(t){return Object(i["b"])().get("api/knowledge/menu_list",{params:t}).then((function(t){return t.data.data}))}function s(t){return Object(i["b"])().get("api/knowledges",{params:t}).then((function(t){return t.data.data}))}function o(t){return Object(i["b"])().get("api/wiki/post",{params:{source_id:t,type:"knowledge"}}).then((function(t){return t.data.data}))}function r(t){return Object(i["b"])().get("api/wiki/post/".concat(t)).then((function(t){return t.data.data}))}function c(t){return Object(i["b"])().get("/api/wiki/posts/newest",{params:t}).then((function(t){return t.data.data}))}function u(t){return Object(i["b"])().get("/api/menu_groups",{params:t}).then((function(t){return t.data.data}))}function d(t){return Object(i["b"])().delete("/api/knowledge/".concat(t))}},"68e8":function(t,e,n){"use strict";n("badb")},"896d":function(t,e,n){},9307:function(t,e,n){"use strict";n("9911"),n("99af");var i=function(){var t=this,e=t._self._c;return e("WikiPanel",{staticClass:"c-wiki-revisions",attrs:{scene:"detail"}},[e("template",{slot:"head-title"},[e("i",{staticClass:"el-icon-time"}),e("span",[t._v("历史版本")])]),e("template",{slot:"body"},[e("div",{staticClass:"m-revisions-panel"},[t.versions&&t.versions.length?t._e():e("div",{staticClass:"u-empty"},[null===t.versions?e("span",[t._v("🎉 数据加载中...")]):t._e(),!1===t.versions?e("span",[t._v("⚠️ 数据加载异常")]):t._e(),t.versions&&!t.versions.length?e("span",[t._v("💧 暂无数据")]):t._e()]),t.versions&&t.versions.length?e("table",{staticClass:"m-histories"},[e("tr",[e("th",[t._v("版本")]),e("th",[t._v("更新时间")]),e("th",[t._v("贡献者")]),e("th",[t._v("修订说明")])]),t._l(t.versions,(function(n,i){return e("tr",{key:i,staticClass:"history"},[e("td",[e("a",{attrs:{href:t.link(t.type,"".concat(n.source_id,"/").concat(n.id))},domProps:{textContent:t._s("v"+(t.versions.length-i))},on:{click:function(e){return t.redirectRevision(n,e)}}})]),e("td",{domProps:{textContent:t._s(t.ts2str(n.updated))}}),e("td",[e("a",{attrs:{href:n.user_id?t.author_url(n.user_id):null},domProps:{textContent:t._s(n.user_nickname)}})]),e("td",{domProps:{textContent:t._s(n.remark)}})])}))],2):t._e()])])],2)},a=[],s=(n("caad"),n("2532"),n("fb6a"),n("ac1f"),n("5319"),n("662c")),o=n("1b86"),r=n("85e4"),c=n("65c2"),u={name:"WikiRevisions",props:["type","sourceId","isGame"],data:function(){return{versions:null}},computed:{client:function(){return location.href.includes("classic")||location.href.includes("origin")?"origin":"std"},baseUrl:function(){return"origin"==this.client?c["__OriginRoot"]:c["__Root"]},prefix:function(){return this.isGame?this.baseUrl.slice(0,-1):""}},methods:{link:function(t,e){return this.prefix+Object(r["getLink"])(t,e)},author_url:function(t){return this.prefix+Object(r["authorLink"])(t)},ts2str:r["ts2str"],redirectRevision:function(t,e){!this.isGame&&this.$router&&(e.preventDefault(),this.$router.replace({path:"/view/".concat(t.source_id,"/").concat(t.id)}))}},components:{WikiPanel:s["a"]},watch:{sourceId:{immediate:!0,handler:function(){var t=this;this.sourceId&&o["a"].versions({type:this.type,id:this.sourceId},{client:this.client}).then((function(e){e=e.data,t.versions=200===e.code&&e.data.versions}),(function(){t.versions=!1}))}}}},d=u,l=(n("68e8"),n("2877")),p=Object(l["a"])(d,i,a,!1,null,null,null);e["a"]=p.exports},badb:function(t,e,n){},d58f:function(t,e,n){var i=n("59ed"),a=n("7b0b"),s=n("44ad"),o=n("07fa"),r=TypeError,c=function(t){return function(e,n,c,u){i(n);var d=a(e),l=s(d),p=o(d),f=t?p-1:0,h=t?-1:1;if(c<2)while(1){if(f in l){u=l[f],f+=h;break}if(f+=h,t?f<0:p<=f)throw r("Reduce of empty array with no initial value")}for(;t?f>=0:p>f;f+=h)f in l&&(u=n(u,l[f],f,d));return u}};t.exports={left:c(!1),right:c(!0)}}}]);
//# sourceMappingURL=chunk-8d5fc176.32a8d353.js.map