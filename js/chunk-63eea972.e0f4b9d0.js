(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63eea972"],{"16f1":function(t,e,a){},"2afb":function(t,e,a){"use strict";a("16f1")},3675:function(t,e,a){"use strict";a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return o})),a.d(e,"g",(function(){return s})),a.d(e,"b",(function(){return c})),a.d(e,"d",(function(){return u})),a.d(e,"e",(function(){return d})),a.d(e,"f",(function(){return l}));var n=a("41cb");function i(t){var e=t.year,a=t.month,n=t.date,i="";return e&&(i+="/".concat(e)),a&&(i+="/".concat(a)),n&&(i+="/".concat(n)),i}function r(t){var e=i(t);return Object(n["a"])().get("/api/cms/calendar/archive"+e)}function o(t){var e=i(t);return Object(n["a"])().post("/api/cms/calendar/archive"+e,t)}function s(t,e){return Object(n["a"])().put("/api/cms/calendar/".concat(t),e)}function l(t,e){return Object(n["a"])().put("/api/cms/calendar/".concat(t,"/manage"),e)}function c(t){return Object(n["a"])().delete("/api/cms/calendar/".concat(t))}function u(t){return Object(n["a"])().get("/api/cms/calendar/".concat(t))}function d(t,e){var a=i(t);return Object(n["a"])().get("/api/cms/calendar/history/".concat(a),{params:e})}},"5e82":function(t,e,a){},"637b":function(t,e,a){},"857a":function(t,e,a){var n=a("e330"),i=a("1d80"),r=a("577e"),o=/"/g,s=n("".replace);t.exports=function(t,e,a,n){var l=r(i(t)),c="<"+e;return""!==a&&(c+=" "+a+'="'+s(r(n),o,"&quot;")+'"'),c+">"+l+"</"+e+">"}},"864b":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.value},on:{close:t.cancel},scopedSlots:t._u([{key:"title",fn:function(){return[a("header",[t._v(t._s(t.title))])]},proxy:!0},{key:"footer",fn:function(){return[a("el-button",{attrs:{size:"medium"},on:{click:t.cancel}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",size:"medium",loading:t.loading},on:{click:t.confirm}},[t._v("确认")])]},proxy:!0}])},[a("main",{staticClass:"u-form"},[a("el-form",{attrs:{"label-position":"left","label-width":"80px"}},[a("el-form-item",{attrs:{label:"日期",required:"",error:t.dateError}},[a("div",{staticClass:"m-date"},[a("el-input-number",{staticClass:"u-date",attrs:{placeholder:"请输入年份",min:2009,max:t.maxYear,size:"medium"},model:{value:t.form.year,callback:function(e){t.$set(t.form,"year",t._n(e))},expression:"form.year"}}),a("el-input-number",{staticClass:"u-date",attrs:{placeholder:"请输入月份",min:1,max:12,size:"medium"},model:{value:t.form.month,callback:function(e){t.$set(t.form,"month",t._n(e))},expression:"form.month"}}),a("el-input-number",{staticClass:"u-date",attrs:{placeholder:"请输入日期",min:1,max:31,size:"medium"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",t._n(e))},expression:"form.date"}})],1)]),a("el-form-item",{attrs:{label:"类型",required:""}},[a("div",{staticClass:"m-type"},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",t._n(e))},expression:"form.type"}},[a("el-radio-button",{attrs:{label:1}},[t._v("事件")]),a("el-radio-button",{attrs:{label:2}},[t._v("活动")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:2===t.form.type,expression:"form.type === 2"}],staticClass:"m-type-icon"},[a("el-input",{attrs:{size:"small",placeholder:"图标ID",minlength:1,maxlength:10,max:3e4,min:0},model:{value:t.form.icon,callback:function(e){t.$set(t.form,"icon",t._n(e))},expression:"form.icon"}},[a("template",{slot:"prepend"},[a("img",{staticClass:"u-icon",attrs:{src:t.iconLink(t.form.icon)}})])],2)],1)],1)]),a("el-form-item",{attrs:{label:"描述",required:"",error:t.descError}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"输入事件描述"},model:{value:t.form.desc,callback:function(e){t.$set(t.form,"desc",e)},expression:"form.desc"}})],1),a("el-form-item",{attrs:{label:"客户端",required:""}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.form.client,callback:function(e){t.$set(t.form,"client",e)},expression:"form.client"}},[a("el-radio-button",{attrs:{label:"std"}},[t._v("正式服")]),a("el-radio-button",{attrs:{label:"origin"}},[t._v("怀旧服")]),1==t.form.type?a("el-radio-button",{attrs:{label:"all"}},[t._v("双端")]):t._e()],1)],1),a("el-form-item",{attrs:{label:"参考资料"}},[t._l(t.form.link,(function(e,n){return[a("div",{key:e.id||n,staticClass:"m-links"},[a("el-input",{staticClass:"u-link-item",attrs:{placeholder:"请输入标题"},model:{value:e.label,callback:function(a){t.$set(e,"label",a)},expression:"item.label"}}),a("el-input",{staticClass:"u-link-item",attrs:{placeholder:"请输入链接"},model:{value:e.url,callback:function(a){t.$set(e,"url",a)},expression:"item.url"}}),a("el-button",{staticClass:"u-del-icon",attrs:{type:"text",icon:"el-icon-circle-close",title:"删除参考资料"},on:{click:function(e){return t.removeLink(n)}}})],1)]})),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus",disabled:t.addDisabled},on:{click:t.addLink}},[t._v("添加")])],2),t.isEditor&&t.isEditmode?[a("el-form-item",{attrs:{label:"置顶显示"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.form.is_top,callback:function(e){t.$set(t.form,"is_top",t._n(e))},expression:"form.is_top"}},[a("el-radio-button",{attrs:{label:0}},[t._v("否")]),a("el-radio-button",{attrs:{label:1}},[t._v("是")])],1)],1),a("el-form-item",{attrs:{label:"重要级别"}},[a("el-input-number",{attrs:{size:"medium",min:0,max:5},model:{value:t.form.level,callback:function(e){t.$set(t.form,"level",t._n(e))},expression:"form.level"}})],1),a("el-form-item",{attrs:{label:"样式"}},[a("div",{staticClass:"m-style"},[a("el-select",{attrs:{size:"medium",placeholder:"请选择样式"},model:{value:t.form.style,callback:function(e){t.$set(t.form,"style",e)},expression:"form.style"}}),a("div",{staticClass:"m-color-item"},[a("label",{staticClass:"u-label"},[t._v("背景色")]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.form.bgcolor,expression:"form.bgcolor"}],staticClass:"u-color-value"},[t._v("【"+t._s(t.form.bgcolor)+"】")]),a("el-color-picker",{attrs:{size:"small",predefine:t.predefineColors},model:{value:t.form.bgcolor,callback:function(e){t.$set(t.form,"bgcolor",e)},expression:"form.bgcolor"}})],1),a("div",{staticClass:"m-color-item"},[a("label",{staticClass:"u-label"},[t._v("颜色")]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.form.color,expression:"form.color"}],staticClass:"u-color-value"},[t._v("【"+t._s(t.form.color)+"】")]),a("el-color-picker",{attrs:{size:"small",predefine:t.predefineColors},model:{value:t.form.color,callback:function(e){t.$set(t.form,"color",e)},expression:"form.color"}})],1)],1)]),a("el-form-item",{attrs:{label:"海报"}},[a("img-upload",{attrs:{data:t.form.banner,filed:"banner"},on:{update:t.setMeta}})],1),a("el-form-item",{attrs:{label:"图片"}},[a("img-upload",{attrs:{data:t.form.img,filed:"img"},on:{update:t.setMeta}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{size:"medium",placeholder:"请输入备注"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1),a("el-form-item",{attrs:{label:"操作"}},[a("el-button",{attrs:{icon:"el-icon-refresh-left",size:"small",type:"warning"},on:{click:t.recheck}},[t._v("复审")]),a("el-button",{attrs:{icon:"el-icon-delete",size:"small",type:"danger"},on:{click:t.del}},[t._v("删除")])],1)]:t._e()],2)],1)])},i=[];a("b64b"),a("a4d3"),a("4de4"),a("d3b7"),a("e439"),a("159b"),a("dbb4");function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function s(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}a("caad"),a("2532"),a("9911f"),a("a434");var l=a("3675"),c=a("c9d2"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-publish-banner"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.url,"show-file-list":!1,"on-success":t.done,"on-error":t.fail,"with-credentials":"",accept:"image/jpg,image/jpeg,image/gif,image/png,image/bmp"}},[t.banner?a("img",{attrs:{src:t._f("showBanner")(t.banner)}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("el-button",{staticClass:"u-remove",attrs:{type:"info",size:"mini",icon:"el-icon-circle-close"},on:{click:t.clearBanner}},[t._v("移除图片")])],1)},d=[],m=(a("99af"),a("65c2")),f=a("85e4"),p=m["__cms"],b=p+"api/cms/upload",h={name:"post_banner",props:["filed","data"],data:function(){return{banner:this.data,url:b}},model:{prop:"data",event:"update"},watch:{data:function(t){this.banner=t},banner:function(t){this.$emit("update",{key:this.filed,val:t})}},methods:{done:function(t,e){this.banner=(null===t||void 0===t?void 0:t.data[0])||""},fail:function(t,e,a){try{var n=JSON.parse(t.message);this.$message.error("[".concat(n.code,"]").concat(n.msg))}catch(i){this.$message.error("网络请求异常")}},clearBanner:function(){this.banner=""}},filters:{showBanner:f["showBanner"]}},v=h,g=(a("9aa7"),a("2877")),_=Object(g["a"])(v,u,d,!1,null,null,null),k=_.exports,y=a("b288"),C={year:2022,month:3,date:16,type:1,desc:"",client:location.href.includes("origin")?"origin":"std",link:[],is_top:0,level:0,remark:"",banner:"",bgcolor:"",color:"",img:"",style:"",icon:0},w={name:"calendar_dialog",components:{"img-upload":k},props:["value","dateObj","selected","mode","isSuper"],data:function(){return{form:s({},Object.assign({},C,this.dateObj)),dateError:"",descError:"",loading:!1,predefineColors:y}},computed:{isEditmode:function(){return"update"==this.mode},title:function(){return this.isEditmode?"编辑":"新增"},maxYear:function(){return(new Date).getFullYear()+1},addDisabled:function(){var t,e;return(null===(t=this.form)||void 0===t||null===(e=t.link)||void 0===e?void 0:e.length)>=10},isEditor:function(){return c["a"].isEditor()}},watch:{selected:{deep:!0,immediate:!0,handler:function(t){t?(this.form=t,this.form.link||(this.form.link=[],this.form.link.push({label:"官网新闻",url:t.link_temp}))):this.form=Object.assign({},C,this.dateObj)}},dateObj:{deep:!0,handler:function(t){t&&(this.form=s(s({},this.form),t||{}))}}},methods:{addLink:function(){var t,e;null===(t=this.form)||void 0===t||null===(e=t.link)||void 0===e||e.push({url:"",label:"",id:+new Date})},removeLink:function(t){var e,a;null===(e=this.form)||void 0===e||null===(a=e.link)||void 0===a||a.splice(t,1)},validate:function(){if(this.form){var t=this.form,e=t.year,a=t.month,n=t.date,i=t.desc;e?(this.dateError="",this.dateError=a?n?"":"请输入日期":"请输入月份"):this.dateError="请输入年份",this.descError=i?"":"请输入事件描述"}},reset:function(){this.$emit("input",!1),this.form=Object.assign({},C,this.dateObj),this.dateError="",this.descError=""},cancel:function(){this.$emit("input",!1)},confirm:function(){var t=this;if(this.validate(),!this.descError&&!this.dateError){this.loading=!0;var e=this.isEditmode?this.put:this.post;e().then((function(){t.reset()})).finally((function(){t.loading=!1}))}},post:function(){var t=this;return Object(l["a"])(this.form).then((function(e){t.$notify({title:"提交成功",message:"请耐心等待审核",type:"success"}),t.$emit("update",e),t.reset()}))},put:function(){var t=this,e=this.isSuper?l["f"]:l["g"];return e(this.selected.id,this.form).then((function(e){t.$emit("update"),t.reset()})).then((function(){t.isSuper?t.$notify({title:"操作成功",message:"日历记录更新成功",type:"success"}):t.$notify({title:"提交成功",message:"请等待重新审核",type:"success"})}))},del:function(){var t=this;Object(l["b"])(this.selected.id).then((function(){t.$emit("del",t.selected.id),t.$notify({type:"success",title:"删除成功",message:"日历记录已删除"})}))},recheck:function(){var t=this;Object(l["f"])(this.selected.id,{status:0}).then((function(){t.$notify({type:"success",title:"操作成功",message:"日历记录已设为待审核"}),t.$emit("del",t.selected.id)}))},setMeta:function(t){var e=t.key,a=t.val;this.form[e]=a},iconLink:f["iconLink"]}},O=w,x=(a("2afb"),Object(g["a"])(O,n,i,!1,null,null,null));e["a"]=x.exports},"9911f":function(t,e,a){"use strict";var n=a("23e7"),i=a("857a"),r=a("af03");n({target:"String",proto:!0,forced:r("link")},{link:function(t){return i(this,"a","href",t)}})},"9aa7":function(t,e,a){"use strict";a("5e82")},af03:function(t,e,a){var n=a("d039");t.exports=function(t){return n((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}},b288:function(t){t.exports=JSON.parse('["#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","rgba(255, 69, 0, 0.68)","rgb(255, 120, 0)","hsv(51, 100, 98)","hsva(120, 40, 94, 0.5)","hsl(181, 100%, 37%)","hsla(209, 100%, 56%, 0.73)","#c7158577"]')},cc1b:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-calendar-detail-item",on:{click:function(e){return t.view(t.data.id)}}},[a("div",{staticClass:"u-primary",attrs:{to:"/view/"+t.data.id}},[2==t.data.type?a("img",{staticClass:"u-icon",attrs:{src:t.iconLink(t.data.icon)}}):a("a",{staticClass:"u-author",attrs:{target:"_blank",href:t.authorLink(t.data.user_id),title:"由"+t.data.user_info.display_name+"贡献"},on:{click:function(t){t.stopPropagation()}}},[a("img",{staticClass:"u-avatar",attrs:{src:t.showAvatar(t.data.user_info.user_avatar),alt:t.data.user_info.display_name}})]),a("span",{staticClass:"u-desc",style:t.descStyle(t.data)},[1==t.data.type?a("i",{staticClass:"u-client",class:t.data.client},[t._v(t._s(t.getClientLabel(t.data.client).slice(0,1)))]):t._e(),t.data.is_top?a("i",{staticClass:"u-star"},[t._v("⭐️")]):t._e(),t._v(t._s(t.data.desc)+" ")])]),a("div",{staticClass:"u-actions"},[a("span",{staticClass:"u-action u-comment"},[a("i",{staticClass:"u-comment-icon el-icon-chat-dot-round"}),a("span",{staticClass:"u-comment-count"},[t._v("评论"),a("em",{staticClass:"u-count"},[t._v("("+t._s(t.data.comments_count||0)+")")])])]),a("span",{staticClass:"u-action u-reference"},[a("i",{staticClass:"u-reference-icon el-icon-connection"}),a("span",{staticClass:"u-reference-count"},[t._v("参考资料"),a("span",{staticClass:"u-count"},[t._v("("+t._s(t.getRefCount(t.data))+")")])])]),t.isEditor?a("span",{staticClass:"u-action u-edit",on:{click:function(e){return e.stopPropagation(),t.edit(t.data)}}},[a("i",{staticClass:"el-icon-edit-outline"}),a("span",{staticClass:"u-edit-text"},[t._v("编辑")])]):t._e()])])},i=[],r=(a("9911f"),a("85e4")),o=a("c9d2"),s=a("65c2"),l={name:"CalendarDetailItem",props:["type","data"],components:{},data:function(){return{}},computed:{isEditor:function(){return o["a"].isEditor()}},watch:{},methods:{view:function(t){this.$router.push("/view/".concat(t))},edit:function(t){this.$emit("edit",t)},authorLink:r["authorLink"],iconLink:r["iconLink"],showAvatar:r["showAvatar"],descStyle:function(t){var e=t.color;return e?{color:e,fontWeight:"bold"}:{}},getRefCount:function(t){var e;return null!==(e=t.link)&&void 0!==e&&e.length?t.link.length:t.link_temp?1:0},getClientLabel:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"std";return s["__clients"][t]}}},c=l,u=(a("e003"),a("2877")),d=Object(u["a"])(c,n,i,!1,null,null,null);e["a"]=d.exports},dbb4:function(t,e,a){var n=a("23e7"),i=a("83ab"),r=a("56ef"),o=a("fc6a"),s=a("06cf"),l=a("8418");n({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(t){var e,a,n=o(t),i=s.f,c=r(n),u={},d=0;while(c.length>d)a=i(n,e=c[d++]),void 0!==a&&l(u,e,a);return u}})},e003:function(t,e,a){"use strict";a("637b")},e439:function(t,e,a){var n=a("23e7"),i=a("d039"),r=a("fc6a"),o=a("06cf").f,s=a("83ab"),l=i((function(){o(1)})),c=!s||l;n({target:"Object",stat:!0,forced:c,sham:!s},{getOwnPropertyDescriptor:function(t,e){return o(r(t),e)}})}}]);
//# sourceMappingURL=chunk-63eea972.e0f4b9d0.js.map