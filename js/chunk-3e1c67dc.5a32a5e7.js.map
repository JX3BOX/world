{"version":3,"sources":["webpack:///./src/views/calendar/Single.vue?3232","webpack:///./src/views/calendar/Single.vue?4d61","webpack:///src/views/calendar/Single.vue","webpack:///./src/views/calendar/Single.vue?4821","webpack:///./src/views/calendar/Single.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","goBack","_v","manage","directives","name","rawName","value","expression","class","today","type","_s","client","desc","user_info","showAvatar","user_avatar","authorLink","user_id","display_name","showTime","created_at","_e","_m","_l","reference","index","key","url","label","item","id","formatDate","author","dateObj","model","callback","$$v","visible","staticRenderFns","components","Comment","data","history","todayLoading","historyLoading","computed","params","month","date","year","references","link","arr","timelineData","acc","watch","immediate","handler","val","deep","methods","loadData","getDetail","then","finally","postStat","loadHistory","getHistory","mode","component"],"mappings":"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","file":"js/chunk-3e1c67dc.5a32a5e7.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Single.vue?vue&type=style&index=0&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-calendar-single\"},[_c('section',{staticClass:\"m-actions\"},[_c('el-button',{attrs:{\"icon\":\"el-icon-arrow-left\",\"size\":\"small\"},on:{\"click\":_vm.goBack}},[_vm._v(\"返回\")]),_c('el-button',{attrs:{\"icon\":\"el-icon-setting\",\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.manage}},[_vm._v(\"管理\")])],1),_c('section',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.todayLoading),expression:\"todayLoading\"}],staticClass:\"m-single-block m-today\"},[_c('header',{staticClass:\"m-single-title m-history-header\"},[_c('i',{class:_vm.today.type == 1 ? 'el-icon-collection-tag' : 'el-icon-s-flag'}),_vm._v(_vm._s(_vm.today.type == 1 ? \"事件\" : \"活动\")+\"记录\")]),_c('div',{staticClass:\"m-today-content\"},[_c('i',{staticClass:\"u-client\",class:_vm.today.client},[_vm._v(_vm._s(_vm.today.client == \"std\" ? \"正式服\" : \"怀旧服\"))]),_vm._v(_vm._s(_vm.today.desc)+\" \")]),(_vm.today && _vm.today.user_info)?_c('div',{staticClass:\"m-today-meta\"},[_c('span',{staticClass:\"u-user\"},[_c('img',{attrs:{\"src\":_vm.showAvatar(_vm.today.user_info.user_avatar),\"width\":\"24\",\"height\":\"24\",\"alt\":\"\"}}),_c('a',{attrs:{\"href\":_vm.authorLink(_vm.today.user_id),\"target\":\"_blank\"}},[_vm._v(_vm._s(_vm.today.user_info.display_name))])]),_c('span',{staticClass:\"u-create-time\",attrs:{\"title\":\"创建时间\"}},[_c('i',{staticClass:\"el-icon-date\"}),_c('time',[_vm._v(_vm._s(_vm.showTime(_vm.today.created_at)))])])]):_vm._e()]),_c('div',{staticClass:\"m-single-block m-reference\"},[_vm._m(0),_vm._l((_vm.references),function(reference,index){return _c('div',{key:index,staticClass:\"m-reference-item\"},[_c('label',{staticClass:\"u-index\"},[_vm._v(_vm._s(index + 1)+\".\")]),_c('a',{staticClass:\"u-link\",attrs:{\"href\":reference.url,\"target\":\"_blank\"}},[_vm._v(_vm._s(reference.label)+\" \"),_c('i',{staticClass:\"el-icon-link\"})])])})],2),_c('section',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.historyLoading),expression:\"historyLoading\"}],staticClass:\"m-single-block m-history\"},[_vm._m(1),_c('div',{staticClass:\"m-history-content\"},[_c('el-timeline'),_vm._l((_vm.history),function(item){return _c('div',{key:item.id,staticClass:\"m-history-item\"},[_c('time',{staticClass:\"u-time\"},[_vm._v(_vm._s(_vm.formatDate(item)))]),_c('router-link',{staticClass:\"u-desc\",attrs:{\"to\":'/detail/' + item.id}},[_vm._v(_vm._s(item.desc)+\" \"),_c('i',{staticClass:\"el-icon-link\"})])],1)})],2)]),_c('Thx',{attrs:{\"postId\":_vm.id,\"postType\":\"calendar\",\"userId\":_vm.author,\"adminBoxcoinEnable\":true,\"userBoxcoinEnable\":true}}),_c('Comment',{staticClass:\"m-comment\",attrs:{\"id\":_vm.id,\"category\":\"calendar\"}}),_c('calendar-dialog',{attrs:{\"date-obj\":_vm.dateObj,\"selected\":_vm.today,\"mode\":\"update\"},model:{value:(_vm.visible),callback:function ($$v) {_vm.visible=$$v},expression:\"visible\"}})],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('header',{staticClass:\"m-single-title m-history-header\"},[_c('i',{staticClass:\"el-icon-connection\"}),_vm._v(\"参考资料\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('header',{staticClass:\"m-single-title m-history-header\"},[_c('i',{staticClass:\"el-icon-date\"}),_vm._v(\"那年今日\")])}]\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"m-calendar-single\">\n        <section class=\"m-actions\">\n            <el-button icon=\"el-icon-arrow-left\" @click=\"goBack\" size=\"small\">返回</el-button>\n            <el-button icon=\"el-icon-setting\" type=\"primary\" size=\"small\" @click=\"manage\">管理</el-button>\n        </section>\n        <section class=\"m-single-block m-today\" v-loading=\"todayLoading\">\n            <!-- {{ today.desc }} -->\n            <header class=\"m-single-title m-history-header\"><i :class=\"today.type == 1 ? 'el-icon-collection-tag' : 'el-icon-s-flag'\"></i>{{ today.type == 1 ? \"事件\" : \"活动\" }}记录</header>\n            <div class=\"m-today-content\">\n                <i class=\"u-client\" :class=\"today.client\">{{ today.client == \"std\" ? \"正式服\" : \"怀旧服\" }}</i\n                >{{ today.desc }}\n            </div>\n            <div class=\"m-today-meta\" v-if=\"today && today.user_info\">\n                <span class=\"u-user\">\n                    <img :src=\"showAvatar(today.user_info.user_avatar)\" width=\"24\" height=\"24\" alt=\"\">\n                    <a\n                        :href=\"authorLink(today.user_id)\"\n                        target=\"_blank\"\n                    >{{ today.user_info.display_name }}</a>\n                </span>\n                <span class=\"u-create-time\" title=\"创建时间\">\n                    <i class=\"el-icon-date\"></i>\n                    <time>{{ showTime(today.created_at) }}</time>\n                </span>\n            </div>\n        </section>\n\n        <div class=\"m-single-block m-reference\">\n            <header class=\"m-single-title m-history-header\"><i class=\"el-icon-connection\"></i>参考资料</header>\n            <div class=\"m-reference-item\" v-for=\"(reference, index) in references\" :key=\"index\">\n                <label class=\"u-index\">{{ index + 1 }}.</label>\n                <a class=\"u-link\" :href=\"reference.url\" target=\"_blank\">{{ reference.label }} <i class=\"el-icon-link\"></i></a>\n            </div>\n        </div>\n\n        <section class=\"m-single-block m-history\" v-loading=\"historyLoading\">\n            <header class=\"m-single-title m-history-header\"><i class=\"el-icon-date\"></i>那年今日</header>\n            <div class=\"m-history-content\">\n                <el-timeline>\n\n                </el-timeline>\n                <div class=\"m-history-item\" v-for=\"item in history\" :key=\"item.id\">\n                    <time class=\"u-time\">{{ formatDate(item) }}</time>\n                    <router-link :to=\"'/detail/' + item.id\" class=\"u-desc\">{{ item.desc }} <i class=\"el-icon-link\"></i></router-link>\n                </div>\n            </div>\n        </section>\n\n        <Thx :postId=\"id\" postType=\"calendar\" :userId=\"author\" :adminBoxcoinEnable=\"true\" :userBoxcoinEnable=\"true\" />\n\n        <Comment class=\"m-comment\" :id=\"id\" category=\"calendar\" />\n\n        <calendar-dialog v-model=\"visible\" :date-obj=\"dateObj\" :selected=\"today\" mode=\"update\"></calendar-dialog>\n    </div>\n</template>\n\n<script>\n    import { getDetail, getHistory } from \"@/service/calendar.js\";\n    import Comment from \"@jx3box/jx3box-comment-ui/src/Comment.vue\";\n    import calendar_dialog from '@/components/calendar/calendar_dialog.vue';\n    import { postStat } from \"@jx3box/jx3box-common/js/stat\";\n    import { showAvatar, authorLink } from '@jx3box/jx3box-common/js/utils';\n    import { showTime } from '@jx3box/jx3box-common/js/moment';\n    export default {\n        name: \"SingleCalendar\",\n        components: {\n            Comment,\n            'calendar-dialog': calendar_dialog,\n        },\n        data() {\n            return {\n                today: \"\",\n                history: {},\n                todayLoading: false,\n                historyLoading: false,\n\n                // 弹窗\n                visible: false\n            };\n        },\n        computed: {\n            id() {\n                return this.$route.params.id;\n            },\n            author() {\n                return this.today.user_id;\n            },\n            params({ today }) {\n                return today\n                    ? {\n                          month: today.month,\n                          date: today.date,\n                      }\n                    : \"\";\n            },\n            dateObj() {\n                return {\n                    year: this.today.year,\n                    month: this.today.month,\n                    date: this.today.date,\n                }\n            },\n            references() {\n                let arr = [];\n                const { link, link_temp, desc } = this.today;\n\n                link && (arr = [...link])\n\n                if (link_temp && !arr.some(item => item.url === link_temp)) {\n                    arr.push({\n                        label: '官方新闻',\n                        url: link_temp\n                    })\n                }\n                return arr\n            },\n            timelineData() {\n                let history;\n                history = this.history.reduce((acc, obj) => {\n                    const key = obj.year;\n                    if (!acc[key]) {\n                        acc[key] = []\n                    }\n                    acc[key].push(obj)\n\n                    return acc\n                }, {})\n\n                return history || {}\n            }\n        },\n        watch: {\n            id: {\n                immediate: true,\n                handler(val) {\n                    if (val) {\n                        this.loadData();\n                    }\n                },\n            },\n            params: {\n                deep: true,\n                handler(val) {\n                    if (val) {\n                        this.loadHistory(val);\n                    }\n                },\n            },\n        },\n        methods: {\n            // ====== 数据获取 ==========\n            loadData() {\n                this.todayLoading = true;\n                getDetail(this.id)\n                    .then((res) => {\n                        this.today = res.data.data;\n                    })\n                    .finally(() => {\n                        postStat(\"calendar\", this.id);\n                        this.todayLoading = false;\n                    });\n            },\n            loadHistory(params) {\n                this.historyLoading = true;\n                getHistory(params, { mode: \"all\" })\n                    .then((res) => {\n                        this.history = (res.data.data || []).reverse();\n                    })\n                    .finally(() => {\n                        this.historyLoading = false;\n                    });\n            },\n\n            // ========= other ==========\n            goBack() {\n                // 如果存在历史则返回上一个记录，否则返回月历页面\n                history.length ? history.go(-1) : this.$router.push(`/archive/${this.dateObj.year}/${this.dateObj.month}`)\n            },\n            manage() {\n                this.visible = true\n            },\n\n            // ========= filters =========\n            formatDate({ year, month, date }) {\n                return `${year}年${month}月${date}日`;\n            },\n            showAvatar(val) {\n                return showAvatar(val, 24)\n            },\n            authorLink,\n            showTime\n        },\n    };\n</script>\n\n<style lang=\"less\">\n    @import \"~@/assets/css/calendar/single.less\";\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Single.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Single.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Single.vue?vue&type=template&id=fc153e0c&\"\nimport script from \"./Single.vue?vue&type=script&lang=js&\"\nexport * from \"./Single.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Single.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}