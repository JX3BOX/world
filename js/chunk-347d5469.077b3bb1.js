(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-347d5469"],{"11a5":function(t,n,i){"use strict";i.r(n);var e=function(){var t=this,n=t._self._c;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"v-knowledge-single"},[n("div",{staticClass:"m-navigation"},[n("el-button",{staticClass:"u-goback",attrs:{size:"medium",icon:"el-icon-arrow-left",plain:""},on:{click:t.goBack}},[t._v("返回列表")]),t.isEditor?n("el-button",{attrs:{size:"medium",icon:"el-icon-delete",plain:"",type:"danger"},on:{click:t.del}},[t._v("删除")]):t._e()],1),t.data&&t.data.post?n("div",{staticClass:"m-wiki"},[n("WikiPanel",{staticClass:"m-knowledge-panel",attrs:{"wiki-post":t.data}},[n("template",{slot:"head-title"},[n("svg",{class:"u-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 412.72 412.72","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[n("path",{attrs:{d:"M404.72 82.944h-27.2v-9.28a8 8 0 00-5.76-8 225.345 225.345 0 00-57.68-7.36c-32 0-75.6 7.2-107.84 40-32-33.12-75.92-40-107.84-40a225.345 225.345 0 00-57.68 7.36 8 8 0 00-5.76 8v9.2H8a8 8 0 00-8 8v255.52a8 8 0 008 8 7.996 7.996 0 003.92-1.04c.8-.4 80.8-44.16 192.48-16h1.92a8.008 8.008 0 001.92 0c112-28.4 192 15.28 192.48 16a8 8 0 0012-6.88V90.944a8 8 0 00-8-8zM16 333.664V98.944h19.12v200.64a8 8 0 009.2 8 350.096 350.096 0 0150-4 207.516 207.516 0 0168.32 10.32A294.1 294.1 0 0016 333.664zm78.32-46a351.994 351.994 0 00-43.52 2.8V79.984a220.645 220.645 0 0147.44-5.28c29.92 0 71.2 6.88 99.84 39.2l.24 199.28c-16.64-10.88-49.12-25.52-104-25.52zm120-173.76c28.64-32 69.92-39.2 99.84-39.2a221.61 221.61 0 0147.44 5.28v210.48a351.895 351.895 0 00-43.28-2.88c-54.56 0-87.12 14.64-104 25.52v-199.2zm182.32 219.76a294.158 294.158 0 00-146.96-19.76 208.008 208.008 0 0168.64-10.32 349.994 349.994 0 0150.32 3.92 8 8 0 009.2-8V98.944h19.12l-.32 234.72z"}})]),n("span",[t._v(t._s(t.title)+" ")])]),n("template",{slot:"head-actions"},[n("a",{staticClass:"el-button el-button--primary",attrs:{href:t.publishLink("knowledge/".concat(t.id))}},[n("i",{staticClass:"el-icon-edit"}),n("span",[t._v("完善百科通识")])])]),n("template",{slot:"body"},[n("Article",{attrs:{content:t.content}}),n("Thx",{key:"item-thx-"+t.id,staticClass:"m-thx",attrs:{postId:t.id,postType:"knowledge",postTitle:t.title,userId:t.author_id,adminBoxcoinEnable:!0,userBoxcoinEnable:!0,mode:"wiki",authors:t.authors}})],1)],2),t.id?n("WikiRevisions",{staticStyle:{"margin-bottom":"35px"},attrs:{type:"knowledge","source-id":t.id}}):t._e(),t.id?[n("el-divider",{attrs:{"content-position":"left"}},[t._v("讨论")]),n("Comment",{attrs:{id:t.id,category:"knowledge"}})]:t._e()],2):n("div",{staticClass:"m-wiki-null"},[n("i",{staticClass:"el-icon-s-opportunity"}),n("span",[t._v("暂无内容，我要")]),n("a",{staticClass:"s-link",attrs:{href:t.publishLink("knowledge/".concat(t.id))}},[t._v("完善百科通识")])])])},a=[],s=(i("b0c0"),i("4de4"),i("d3b7"),i("d81d"),i("14d9"),i("434b")),o=i("9616"),r=i("85e4"),c=i("662c"),u=i("9307"),d=i("c9d2"),l=i("a974"),p=i("23d8"),h={name:"Detail",data:function(){return{loading:!1,data:""}},components:{Article:l["a"],WikiPanel:c["a"],WikiRevisions:u["a"],Comment:p["a"]},computed:{id:function(){return this.$route.params.source_id},type:function(){var t,n;return null===(t=this.data)||void 0===t||null===(n=t.source)||void 0===n?void 0:n.type},isRevision:function(){return!!this.$route.params.post_id},author_id:function(){var t,n;return~~(null===(t=this.data)||void 0===t||null===(n=t.post)||void 0===n?void 0:n.user_id)},title:function(){var t,n;return null===(t=this.data)||void 0===t||null===(n=t.source)||void 0===n?void 0:n.name},content:function(){var t,n;return null===(t=this.data)||void 0===t||null===(n=t.post)||void 0===n?void 0:n.content},authors:function(){var t,n,i;return this.isRevision?[]:(null===(t=this.data)||void 0===t||null===(n=t.users)||void 0===n||null===(i=n.filter((function(t){return t.id})))||void 0===i?void 0:i.map((function(t){return{user_id:t.id,user_avatar:t.avatar,display_name:t.nickname}})))||[]},isEditor:function(){return d["a"].isEditor()}},methods:{getData:function(){var t=this;this.loading=!0,Object(s["a"])(this.id).then((function(n){t.data=n,t.data.source&&(t.data.source.post=t.data.post)})).finally((function(){t.loading=!1,Object(o["c"])(t.type,t.id)}))},getPostData:function(){var t=this;this.loading=!0,Object(s["d"])(this.$route.params.post_id).then((function(n){t.data=n,t.data.source&&(t.data.source.post=t.data.post)})).finally((function(){t.loading=!1,Object(o["c"])(t.type,t.id)}))},goBack:function(){var t,n;null!==(t=this.data)&&void 0!==t&&null!==(n=t.source)&&void 0!==n&&n.type?this.$router.push({name:"normal",params:{knowledge_type:this.data.source.type}}):this.$router.push({name:"index"})},publishLink:r["publishLink"],del:function(){var t=this;this.$confirm("此操作将永久删除该百科通识, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["g"])(t.id).then((function(n){t.$message({type:"success",message:"删除成功!"}),t.goBack()})).catch((function(n){t.$message({type:"error",message:"删除失败!"})}))}))}},created:function(){this.getData(this.id)},watch:{"$route.params.post_id":{immediate:!0,handler:function(){this.$route.params.post_id&&this.getPostData()}}}},v=h,f=(i("2fc3"),i("2877")),m=Object(f["a"])(v,e,a,!1,null,null,null);n["default"]=m.exports},"2fc3":function(t,n,i){"use strict";i("896d")},"434b":function(t,n,i){"use strict";i.d(n,"b",(function(){return a})),i.d(n,"e",(function(){return s})),i.d(n,"a",(function(){return o})),i.d(n,"d",(function(){return r})),i.d(n,"c",(function(){return c})),i.d(n,"f",(function(){return u})),i.d(n,"g",(function(){return d}));var e=i("41cb");function a(t){return Object(e["b"])().get("api/knowledge/menu_list",{params:t}).then((function(t){return t.data.data}))}function s(t){return Object(e["b"])().get("api/knowledges",{params:t}).then((function(t){return t.data.data}))}function o(t){return Object(e["b"])().get("api/wiki/post",{params:{source_id:t,type:"knowledge"}}).then((function(t){return t.data.data}))}function r(t){return Object(e["b"])().get("api/wiki/post/".concat(t)).then((function(t){return t.data.data}))}function c(t){return Object(e["b"])().get("/api/wiki/posts/newest",{params:t}).then((function(t){return t.data.data}))}function u(t){return Object(e["b"])().get("/api/menu_groups",{params:t}).then((function(t){return t.data.data}))}function d(t){return Object(e["b"])().delete("/api/knowledge/".concat(t))}},"68e8":function(t,n,i){"use strict";i("badb")},"896d":function(t,n,i){},9307:function(t,n,i){"use strict";i("9911"),i("99af");var e=function(){var t=this,n=t._self._c;return n("WikiPanel",{staticClass:"c-wiki-revisions",attrs:{scene:"detail"}},[n("template",{slot:"head-title"},[n("i",{staticClass:"el-icon-time"}),n("span",[t._v("历史版本")])]),n("template",{slot:"body"},[n("div",{staticClass:"m-revisions-panel"},[t.versions&&t.versions.length?t._e():n("div",{staticClass:"u-empty"},[null===t.versions?n("span",[t._v("🎉 数据加载中...")]):t._e(),!1===t.versions?n("span",[t._v("⚠️ 数据加载异常")]):t._e(),t.versions&&!t.versions.length?n("span",[t._v("💧 暂无数据")]):t._e()]),t.versions&&t.versions.length?n("table",{staticClass:"m-histories"},[n("tr",[n("th",[t._v("版本")]),n("th",[t._v("更新时间")]),n("th",[t._v("贡献者")]),n("th",[t._v("修订说明")])]),t._l(t.versions,(function(i,e){return n("tr",{key:e,staticClass:"history"},[n("td",[n("a",{attrs:{href:t.link(t.type,"".concat(i.source_id,"/").concat(i.id))},domProps:{textContent:t._s("v"+(t.versions.length-e))},on:{click:function(n){return t.redirectRevision(i,n)}}})]),n("td",{domProps:{textContent:t._s(t.ts2str(i.updated))}}),n("td",[n("a",{attrs:{href:i.user_id?t.author_url(i.user_id):null},domProps:{textContent:t._s(i.user_nickname)}})]),n("td",{domProps:{textContent:t._s(i.remark)}})])}))],2):t._e()])])],2)},a=[],s=(i("caad"),i("2532"),i("fb6a"),i("ac1f"),i("5319"),i("662c")),o=i("1b86"),r=i("85e4"),c=i("65c2"),u={name:"WikiRevisions",props:["type","sourceId","isGame"],data:function(){return{versions:null}},computed:{client:function(){return location.href.includes("classic")||location.href.includes("origin")?"origin":"std"},baseUrl:function(){return"origin"==this.client?c["__OriginRoot"]:c["__Root"]},prefix:function(){return this.isGame?this.baseUrl.slice(0,-1):""}},methods:{link:function(t,n){return this.prefix+Object(r["getLink"])(t,n)},author_url:function(t){return this.prefix+Object(r["authorLink"])(t)},ts2str:r["ts2str"],redirectRevision:function(t,n){!this.isGame&&this.$router&&(n.preventDefault(),this.$router.replace({path:"/view/".concat(t.source_id,"/").concat(t.id)}))}},components:{WikiPanel:s["a"]},watch:{sourceId:{immediate:!0,handler:function(){var t=this;this.sourceId&&o["a"].versions({type:this.type,id:this.sourceId},{client:this.client}).then((function(n){n=n.data,t.versions=200===n.code&&n.data.versions}),(function(){t.versions=!1}))}}}},d=u,l=(i("68e8"),i("2877")),p=Object(l["a"])(d,e,a,!1,null,null,null);n["a"]=p.exports},badb:function(t,n,i){}}]);
//# sourceMappingURL=chunk-347d5469.077b3bb1.js.map